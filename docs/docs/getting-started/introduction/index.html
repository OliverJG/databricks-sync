<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://databrickslabs.github.io/databricks-sync/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://databrickslabs.github.io/databricks-sync/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=https://databrickslabs.github.io/databricks-sync/main.df6aa784b8e5b82d4caa8f7b97278967415abea50bedc71dac34ba58c2b776c4b053b2fb71c0a14da0e61ccf5bc4d0140c566d4e00b98c9fac103871769fb6ea.css integrity="sha512-32qnhLjluC1Mqo97lyeJZ0FavqUL7ccdrDS6WMK3dsSwU7L7ccChTaDmHM9bxNAUDFZtTgC5jJ+sEDhxdp+26g==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Introduction - Databricks Sync</title><meta name=description content="A tool used to synchronize a source Databricks deployment with a target Databricks deployment. Useful for migration and Disaster Recovery."><link rel=canonical href=https://databrickslabs.github.io/databricks-sync/docs/getting-started/introduction/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/docs/getting-started/introduction/solution-arch.png"><meta name=twitter:title content="Introduction"><meta name=twitter:description content="A tool used to synchronize a source Databricks deployment with a target Databricks deployment. Useful for migration and Disaster Recovery."><meta name=twitter:site content="@"><meta name=twitter:creator content="@"><meta property="og:title" content="Introduction"><meta property="og:description" content="A tool used to synchronize a source Databricks deployment with a target Databricks deployment. Useful for migration and Disaster Recovery."><meta property="og:type" content="article"><meta property="og:url" content="/docs/getting-started/introduction/"><meta property="og:image" content="/docs/getting-started/introduction/solution-arch.png"><meta property="article:published_time" content="2020-10-06T08:48:57+00:00"><meta property="article:modified_time" content="2020-10-06T08:48:57+00:00"><meta property="og:site_name" content="Databricks Sync"><meta property="article:publisher" content="https://www.facebook.com/"><meta property="article:author" content="https://www.facebook.com/"><meta property="og:locale" content><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/databrickslabs.github.io\/databricks-sync\/"},{"@type":"ListItem","position":3,"name":"Docs","item":"https:\/\/databrickslabs.github.io\/databricks-sync\/\/docs\/"},{"@type":"ListItem","position":4,"name":"Getting Started","item":"https:\/\/databrickslabs.github.io\/databricks-sync\/\/docs\/getting-started\/"},{"@type":"ListItem","position":5,"name":"Introduction","item":"https:\/\/databrickslabs.github.io\/databricks-sync\/\/docs\/getting-started\/introduction\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://databrickslabs.github.io/databricks-sync/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://databrickslabs.github.io/databricks-sync/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://databrickslabs.github.io/databricks-sync/favicon-16x16.png><link rel=manifest href=https://databrickslabs.github.io/databricks-sync/site.webmanifest></head><body class="docs single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 me-auto" href=https://databrickslabs.github.io/databricks-sync/>Databricks Sync</a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/databrickslabs/databricks-sync><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ms-2 visually-hidden">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav me-auto order-5 order-md-2"><li class="nav-item active"><a class=nav-link href=https://databrickslabs.github.io/databricks-sync/docs/getting-started/introduction/>Docs</a></li><li class=nav-item><a class=nav-link href=https://databrickslabs.github.io/databricks-sync/changelog/release-0.2.0>Changelog</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>Getting Started</h3><ul class=list-unstyled><li><a class="docs-link active" href=https://databrickslabs.github.io/databricks-sync/docs/getting-started/introduction/>Introduction</a></li><li><a class=docs-link href=https://databrickslabs.github.io/databricks-sync/docs/getting-started/setup/>Setup</a></li></ul><h3>Commands</h3><ul class=list-unstyled><li><a class=docs-link href=https://databrickslabs.github.io/databricks-sync/docs/commands/usage/>Usage</a></li><li><a class=docs-link href=https://databrickslabs.github.io/databricks-sync/docs/commands/init/>Init</a></li><li><a class=docs-link href=https://databrickslabs.github.io/databricks-sync/docs/commands/export/>Export</a></li><li><a class=docs-link href=https://databrickslabs.github.io/databricks-sync/docs/commands/import/>Import</a></li></ul><h3>Databricks Objects</h3><ul class=list-unstyled><li><a class=docs-link href=https://databrickslabs.github.io/databricks-sync/docs/databricks-objects/workspace-notebooks/>Notebooks</a></li><li><a class=docs-link href=https://databrickslabs.github.io/databricks-sync/docs/databricks-objects/workspace-global-init-scripts/>Global Init Scripts</a></li><li><a class=docs-link href=https://databrickslabs.github.io/databricks-sync/docs/databricks-objects/workspace-cluster-policies/>Cluster Policies</a></li><li><a class=docs-link href=https://databrickslabs.github.io/databricks-sync/docs/databricks-objects/workspace-dbfs-files/>DBFS Files</a></li><li><a class=docs-link href=https://databrickslabs.github.io/databricks-sync/docs/databricks-objects/workspace-instance-pools/>Instance Pools</a></li><li><a class=docs-link href=https://databrickslabs.github.io/databricks-sync/docs/databricks-objects/workspace-secrets/>Secrets</a></li><li><a class=docs-link href=https://databrickslabs.github.io/databricks-sync/docs/databricks-objects/workspace-clusters/>Clusters</a></li><li><a class=docs-link href=https://databrickslabs.github.io/databricks-sync/docs/databricks-objects/workspace-jobs/>Jobs</a></li><li><a class=docs-link href=https://databrickslabs.github.io/databricks-sync/docs/databricks-objects/workspace-identities/>Identity + Scim</a></li></ul><h3>Azure Migration</h3><ul class=list-unstyled><li><a class=docs-link href=https://databrickslabs.github.io/databricks-sync/docs/azure-migration/export_notebook/>Export Notebook</a></li></ul><h3>Aws Migration</h3><h3>Help</h3><ul class=list-unstyled><li><a class=docs-link href=https://databrickslabs.github.io/databricks-sync/docs/help/faq/>FAQ</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#reference-architecture>Reference Architecture</a></li><li><a href=#quickstart>Quickstart</a><ul><li><a href=#basic-setup>Basic Setup</a></li><li><a href=#common-commands>Common commands</a></li><li><a href=#backend-instructions-storing-terraform-state-in-azure-blob-or-aws-s3>Backend Instructions (Storing terraform state in azure blob or aws s3)</a></li><li><a href=#docker-instructions>Docker instructions</a></li><li><a href=#support-matrix-for-import-and-export-operations>Support Matrix for Import and Export Operations:</a></li></ul></li><li><a href=#project-support>Project Support</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>Introduction</h1><p class=lead>A tool used to a synchronize source Databricks deployment with a target Databricks deployment. Useful for migration and Disaster Recovery.</p><h2 id=reference-architecture>Reference Architecture<a href=#reference-architecture class=anchor aria-hidden=true>#</a></h2><figure class=border-0><img class="img-fluid lazyload blur-up" data-sizes=auto src=https://databrickslabs.github.io/databricks-sync/docs/getting-started/introduction/solution-arch_hudacf06c995c8c4a396662145c967f4e3_374691_20x0_resize_box_2.png data-srcset="https://databrickslabs.github.io/databricks-sync/docs/getting-started/introduction/solution-arch_hudacf06c995c8c4a396662145c967f4e3_374691_900x0_resize_box_2.png 900w,https://databrickslabs.github.io/databricks-sync/docs/getting-started/introduction/solution-arch_hudacf06c995c8c4a396662145c967f4e3_374691_800x0_resize_box_2.png 800w,https://databrickslabs.github.io/databricks-sync/docs/getting-started/introduction/solution-arch_hudacf06c995c8c4a396662145c967f4e3_374691_700x0_resize_box_2.png 700w,https://databrickslabs.github.io/databricks-sync/docs/getting-started/introduction/solution-arch_hudacf06c995c8c4a396662145c967f4e3_374691_600x0_resize_box_2.png 600w,https://databrickslabs.github.io/databricks-sync/docs/getting-started/introduction/solution-arch_hudacf06c995c8c4a396662145c967f4e3_374691_500x0_resize_box_2.png 500w" width=2208 height=1048 alt=SolutionArchitecture><noscript><img class=img-fluid sizes=100vw srcset="https://databrickslabs.github.io/databricks-sync/docs/getting-started/introduction/solution-arch_hudacf06c995c8c4a396662145c967f4e3_374691_900x0_resize_box_2.png 900w,https://databrickslabs.github.io/databricks-sync/docs/getting-started/introduction/solution-arch_hudacf06c995c8c4a396662145c967f4e3_374691_800x0_resize_box_2.png 800w,https://databrickslabs.github.io/databricks-sync/docs/getting-started/introduction/solution-arch_hudacf06c995c8c4a396662145c967f4e3_374691_700x0_resize_box_2.png 700w,https://databrickslabs.github.io/databricks-sync/docs/getting-started/introduction/solution-arch_hudacf06c995c8c4a396662145c967f4e3_374691_600x0_resize_box_2.png 600w,https://databrickslabs.github.io/databricks-sync/docs/getting-started/introduction/solution-arch_hudacf06c995c8c4a396662145c967f4e3_374691_500x0_resize_box_2.png 500w" src=https://databrickslabs.github.io/databricks-sync/docs/getting-started/introduction/solution-arch.png width=2208 height=1048 alt=SolutionArchitecture></noscript><figcaption class=figure-caption><em>Databricks Sync Reference Architecture</em></figcaption></figure><h2 id=quickstart>Quickstart<a href=#quickstart class=anchor aria-hidden=true>#</a></h2><h3 id=basic-setup>Basic Setup<a href=#basic-setup class=anchor aria-hidden=true>#</a></h3><ul><li>Configure <a href=https://github.com/databrickslabs/databricks-sync/blob/master/tests/integration_test.yaml>YAML file</a>.</li><li>Export object permissions and import them to the target with the object</li><li>TODO: Add examples for different scenarios:<ul><li>Backup and Restore</li><li>CI/CD</li><li>Disaster Recovery Sync</li><li>Batch modification (will require Terraform Object Import support)</li></ul></li></ul><h3 id=common-commands>Common commands<a href=#common-commands class=anchor aria-hidden=true>#</a></h3><pre><code class=language-bash>$ databricks-sync init my-export-config

$ databricks-sync  export \
    --profile &lt;db cli profile&gt; \
    --git-ssh-url git@github.com:..../.....git \
    -c ....test.yaml

optional flags:
    -v DEBUG
    --dry-run
    --dask
    --branch # support new main name convention

$ GIT_PYTHON_TRACE=full databricks-sync import \
    -g git@github.com:.../....git \
    --profile dr_tagert \
    --databricks-object-type cluster_policy \
    --artifact-dir ..../dir \
    --plan \
    --skip-refresh \
    --revision ....
</code></pre><p>Control the databricks provider version by using:</p><pre><code>export DATABRICKS_TERRAFORM_PROVIDER_VERSION=&quot;&lt;version here&gt;&quot;
</code></pre><h3 id=backend-instructions-storing-terraform-state-in-azure-blob-or-aws-s3>Backend Instructions (Storing terraform state in azure blob or aws s3)<a href=#backend-instructions-storing-terraform-state-in-azure-blob-or-aws-s3 class=anchor aria-hidden=true>#</a></h3><p>When importing you are able to store and manage your state using blob or s3. You can do this by using the <code>--backend-file</code>.
This <code>--backend-file</code> will take a file path to the back end file. You can name the file <code>backend.tf</code>. This backend file will use
azure blob or aws s3 to manage the state file. To authenticate to either you will use environment variables.</p><p>Please use <code>ARM_SAS_TOKEN</code> or <code>ARM_ACCESS_KEY</code> for sas token and account access key respectively for azure blob.
Please use <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_SECRET_ACCESS_KEY</code> for the key and secret for the s3 bucket. Please go the following links in
regards to policies and permissions. If you want to make the region dynamic you can use <code>AWS_DEFAULT_REGION</code>.</p><ol><li>Storing state in <strong>aws s3</strong>: <a href=https://www.terraform.io/docs/backends/types/s3.html>https://www.terraform.io/docs/backends/types/s3.html</a></li><li>Storing state in <strong>azure blob</strong>: <a href=https://www.terraform.io/docs/backends/types/azurerm.html>https://www.terraform.io/docs/backends/types/azurerm.html</a></li></ol><h3 id=docker-instructions>Docker instructions<a href=#docker-instructions class=anchor aria-hidden=true>#</a></h3><p>These set of instructions are to use docker to build and use the CLI. It avoids the need to have golang,
Terraform, the databricks-terraform-provider to get this to run. If you do want to work on this tool please
install the prior listed tools to get this to work.</p><p>To install this tool please run the following command:</p><pre><code class=language-bash>$ docker build -t databricks-sync:latest .
</code></pre><h4 id=aliasing>Aliasing<a href=#aliasing class=anchor aria-hidden=true>#</a></h4><p>How our alias command works:</p><p>This script creates 3 volume mounts with docker of which two are read only.</p><ol><li>We mount <code>$PWD</code> or present working directory to <code>/usr/src/databricks-sync</code> as that is the working directory.
This allows you to manipulate files in the local working directory on your host machine.</li><li>The second mount is mounting <code>~/.databrickscfg</code> to <code>/root</code> as that is the home directory of the container.
This mount is read only.</li><li>The third mount is mounting <code>~/.ssh</code> folder to the <code>/root/.ssh</code> folder. This is so the script can fetch your
private keys in a read only fashion for accessing the git repository. This is also a read only mount.</li></ol><pre><code class=language-bash>alias dbt='docker run -it --rm --name docker-databricks-sync --env-file &lt;(env | grep -e &quot;[ARM|TF_VAR]&quot;) -v &quot;$PWD&quot;:/usr/src/databricks-sync -v ~/.databrickscfg:/root/.databrickscfg:ro -v ~/.ssh:/root/.ssh:ro -w /usr/src/databricks-sync databricks-sync'
</code></pre><h3 id=support-matrix-for-import-and-export-operations>Support Matrix for Import and Export Operations:<a href=#support-matrix-for-import-and-export-operations class=anchor aria-hidden=true>#</a></h3><table><thead><tr><th>Component</th><th>Export to HCL</th><th>Import to Workspace</th></tr></thead><tbody><tr><td><strong>User Objects</strong></td><td></td><td></td></tr><tr><td>cluster policy</td><td>✅</td><td>✅</td></tr><tr><td>cluster</td><td>✅</td><td>✅</td></tr><tr><td>dbfs file</td><td>✅</td><td>✅</td></tr><tr><td>instance pool</td><td>✅</td><td>✅</td></tr><tr><td>instance profile</td><td>✅</td><td>✅</td></tr><tr><td>job</td><td>✅</td><td>✅</td></tr><tr><td>notebook</td><td>✅</td><td>✅</td></tr><tr><td>global init scripts</td><td>✅</td><td>✅</td></tr><tr><td><strong>Administrator Setup</strong></td><td></td><td></td></tr><tr><td>aws s3 mount</td><td>⬜️</td><td>⬜️</td></tr><tr><td>azure adls gen1 mount</td><td>⬜️</td><td>⬜️</td></tr><tr><td>azure adls gen2 mount</td><td>⬜️</td><td>⬜️</td></tr><tr><td>azure blob mount</td><td>⬜️</td><td>⬜️</td></tr><tr><td>secret</td><td>✅</td><td>✅</td></tr><tr><td>secret acl</td><td>✅</td><td>✅</td></tr><tr><td>secret scope</td><td>✅</td><td>✅</td></tr><tr><td>metastore tables</td><td>⬜️</td><td>⬜️</td></tr><tr><td>metastore table ACLs</td><td>⬜️</td><td>⬜️</td></tr><tr><td><strong>Users Management</strong></td><td></td><td></td></tr><tr><td>group</td><td>✅</td><td>✅</td></tr><tr><td>group instance profile</td><td>✅</td><td>✅</td></tr><tr><td>group member</td><td>✅</td><td>✅</td></tr><tr><td>scim user</td><td>✅</td><td>✅</td></tr></tbody></table><h2 id=project-support>Project Support<a href=#project-support class=anchor aria-hidden=true>#</a></h2><p>Please note that all projects in the /databrickslabs github account are provided for your exploration only, and are not formally supported by Databricks with Service Level Agreements (SLAs). They are provided AS-IS and we do not make any guarantees of any kind. Please do not submit a support ticket relating to any issues arising from the use of these projects.</p><p>Any issues discovered through the use of this project should be filed as GitHub Issues on the Repo. They will be reviewed as time permits, but there are no formal SLAs for support.</p><div class="docs-navigation d-flex justify-content-between"><a class=ms-auto href=https://databrickslabs.github.io/databricks-sync/docs/getting-started/setup/><div class="card my-1"><div class="card-body py-2">Setup &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://gohugo.io/>Hugo</a>, and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://databrickslabs.github.io/databricks-sync/js/bootstrap.min.2374eee79bc19379a4404a900e042aef91675978a6686beeb97b3b0fa80af5c349abc1304de36298d942cde796148b853299ff49801257ee2b89e89ac427d75b.js integrity="sha512-I3Tu55vBk3mkQEqQDgQq75FnWXimaGvuuXs7D6gK9cNJq8EwTeNimNlCzeeWFIuFMpn/SYASV+4rieiaxCfXWw==" crossorigin=anonymous defer></script><script src=https://databrickslabs.github.io/databricks-sync/js/highlight.min.db065ca87df0220529f95e26ad6ca3145048cb172991ec33d6642a4a66f07f05b2c222f9291a669aa05996099b959102e221ecc45fe17e52b75cbcd314bdd255.js integrity="sha512-2wZcqH3wIgUp+V4mrWyjFFBIyxcpkewz1mQqSmbwfwWywiL5KRpmmqBZlgmblZEC4iHsxF/hflK3XLzTFL3SVQ==" crossorigin=anonymous defer></script><script src=https://databrickslabs.github.io/databricks-sync/main.min.7ab523108435955765bcb88a0ee704f412ba01646b5478e84f3b9feb24f0ce750a14c3f7bd9a62408fe21e41996d361a9eb29f77e85dfe77b7e17f7623bd3a97.js integrity="sha512-erUjEIQ1lVdlvLiKDucE9BK6AWRrVHjoTzuf6yTwznUKFMP3vZpiQI/iHkGZbTYanrKfd+hd/ne34X92I706lw==" crossorigin=anonymous defer></script><script src=https://databrickslabs.github.io/databricks-sync/index.min.d3fa2edf50d7aae80e8d1cf8424e47f87d304859bd05caca8dce8be5beedc9589a7ff6a99357b0cf2b3bb82263b8c07e70fd9905d886c4e3cb16feafa9a678cd.js integrity="sha512-0/ou31DXqugOjRz4Qk5H+H0wSFm9BcrKjc6L5b7tyViaf/apk1ewzys7uCJjuMB+cP2ZBdiGxOPLFv6vqaZ4zQ==" crossorigin=anonymous defer></script></body></html>